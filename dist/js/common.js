"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},feed=location.host.split(".")[0],URL=window.location.protocol+"//"+feed+"api.v114.com",URL="http://liveapi.v114.com",columnid=getQueryStringByName("columnid");function goBack(){window.history.back()}function getCompanyId(e){var a=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==a||a.length<1?"":a[1]}$(".back").click(function(){goBack()});var timeflag2,timeflag=(new Date).getTime();function getCode(){$(".picImg").prop("src",URL+"/appapi/wx/getimgcode?timeflag="+timeflag),timeflag2=timeflag,timeflag=(new Date).getTime()}function showTip(e){var a=$("<div class='tip'><div class='fadeIn'>"+e+"</div></div>");$("body").append(a),setTimeout(function(){a.remove()},2e3)}function showError(e){$("."+e).css({visibility:"visible"}),setTimeout(function(){$("."+e).css({visibility:"hidden"})},2e3)}getCode();var mo=function(e){e.preventDefault()};function stop(){document.body.style.overflow="hidden",document.addEventListener("touchmove",mo,!1)}function move(){document.body.style.overflow="",document.removeEventListener("touchmove",mo,!1)}function focusId(e){var a,o;0<e.length&&(o=(a=document.getElementById(e)).value,a.value="",a.value=o,document.getElementById(e).focus())}function isPhoneNumber(e){var a=null!=e&&""!=e?!0:!1;11!=e.length&&(a=!1);return e.match("^[1][3,4,5,7,8][0-9]{9}$")||(a=!1),a}function setRemainTime(){count<=0?($("#stext").show(),$("#timer").hide(),count=60,generate=!1):($("#timer").html(count+"s后重发"),count--,setTimeout(setRemainTime,1e3))}function checkPhone(e){return!(11!=e.length||!isPhoneNumber(e))}function getQueryStringByName(e){var a=location.search.match(new RegExp("[?&]"+e+"=([^&]+)","i"));return null==a||a.length<1?"":a[1]}function getUrlParam(e){var a=window.location.search,o=new RegExp("(^|&)"+e+"=([^&]*)(&|$)"),n=a.substr(1).match(o);return n?decodeURIComponent(n[2]):null}var company_id=getCompanyId("__biz")?getCompanyId("__biz"):getCompanyId("qy_companyid"),qy_CompanyId=getCompanyId("qy_companyid")?getCompanyId("qy_companyid"):company_id;function acquireTitle(){$.ajax({url:"http://livetapi.v114.com/appapi/wx/title",type:"get",dataType:"json",data:{id:company_id},error:function(e){console.log(e)},success:function(e){var a;console.log(e),0==e.state.rc&&(a=e.state.title,localStorage.qy_title=a,$("title").html(a))}})}if(localStorage.companyId=localStorage.companyId?localStorage.companyId:qy_CompanyId,acquireTitle(),"NzM="==company_id){var getToken=function(){if(!zhixinHybrid.isAvailable("getToken"))return console.log("不支持该环境"),void _showError("不支持该环境");var e=zhixinHybrid.requestHybridToZHIXIN({tagname:"getToken()",callback:function(){localStorage.s_id=e,s_id=e,getUserName()}})},getUserName=function(){$.getJSON(URL+"/wx/getuserinfo",{sid:localStorage.s_id},function(e){alert(data+"username");var a=data.userinfo.username;localStorage.cu_user_name=a,alert(localStorage.cu_user_name)})},_showError=function(e){var a=$("<div style='position: fixed;left: 0;top: 0;bottom: 0;right: 0;background: #000;opacity: 0.6;z-index: 99'></div>"),o=$("<div class='tip'><div class='' style='opacity: 1;'>"+e+"</div></div>");$("body").append(a),$("body").append(o)};$("body").append('<script src="js/zhixinHybrid.min.js"><\/script>');var s_id="";try{window.afterZhiXinLoad=function(){console.log("after onZhixinLoad end"),getToken()},window.afterZhiXinLoad(),s_id||(window.onZhiXinLoad=function(){console.log("Android or IOS has already prepared."),zhixinHybrid.prepared=!0,zhixinHybrid.requestHybridToZHIXIN({tagname:"getToken()",callback:function(e){var a="";return"object"===(void 0===e?"undefined":_typeof(e))?a=e.sid:"string"==typeof e&&(a=e),a?(localStorage.s_id=a,getUserName(),console.log("getToken sid: "+a),"sucess"):(console.log("获取sessionId失败"),localStorage.s_id=null,_showError("该链接不允许在CU客户端外打开"),"fail")}})})}catch(e){_showError("该链接不允许在CU客户端外打开")}}var navArr=[],comidArr=[];if(localStorage.navArr){$(".menu_Nav").empty();var str="";$.each(JSON.parse(localStorage.navArr),function(e,a){str+='<span><a href="channel.html?qy_companyid='+company_id+"&columnid="+JSON.parse(localStorage.comidArr)[e]+'">'+a+"</a></span>"}),$(".menu_Nav").prepend(str),localStorage.countNav<=3?$(".menu_Nav").css("width","100%"):$(".menu_Nav").css("width",40*localStorage.countNav+"%"),$(".menu_Nav span a").eq(0).prop("href","index.html?__biz="+company_id),"客户经理"==$(".menu_Nav span a").last().html()&&$(".menu_Nav span a").last().prop("href","manager.html?columnid=001&qy_companyid="+company_id),columnid||$(".menu_Nav span a").eq(0).addClass("spanActive");for(var i=0;i<JSON.parse(localStorage.comidArr).length;i++)JSON.parse(localStorage.comidArr)[i]==columnid&&($(".menu_Nav span a").removeClass("spanActive"),$(".menu_Nav span a").eq(0).removeClass("spanActive"),$(".menu_Nav span a").eq(i).addClass("spanActive"),2<i&&$("header").animate({scrollLeft:85*i+"%"},300))}$.ajax({url:URL+"/appapi/wx/channel",type:"get",dataType:"json",cache:!1,data:{id:company_id},error:function(e){console.log(e)},success:function(e){if(console.log(e),0<=e.state.rc){var a;a=0<=e.result.type?e.result.totalcount+1:e.result.totalcount,localStorage.countNav=a;var o=e.result.items;if(localStorage.navArr)$.each(o,function(e,a){navArr.push(a.name),comidArr.push(a.columnid)}),1==e.result.type&&(navArr.push("客户经理"),comidArr.push("001")),localStorage.navArr=JSON.stringify(navArr),localStorage.comidArr=JSON.stringify(comidArr);else{var n="";if($.each(o,function(e,a){navArr.push(a.name),comidArr.push(a.columnid),n+='<span><a href="channel.html?qy_companyid='+company_id+"&columnid="+a.columnid+'">'+a.name+"</a></span>"}),1==e.result.type&&(navArr.push("客户经理"),comidArr.push("001"),n+=' <span><a href="./manager.html?columnid=001&qy_companyid='+company_id+">客户经理</a></span>"),$(".menu_Nav").prepend(n),a<=3?$(".menu_Nav").css("width","100%"):$(".menu_Nav").css("width",40*a+"%"),$(".menu_Nav span a").eq(0).prop("href","index.html?__biz="+company_id),columnid)for(var t=0;t<comidArr.length;t++)comidArr[t]==columnid&&($(".menu_Nav span a").removeClass("spanActive"),$(".menu_Nav span a").eq(0).removeClass("spanActive"),$(".menu_Nav span a").eq(t).addClass("spanActive"),2<t&&$("header").animate({scrollLeft:85*t+"%"},300));else $(".menu_Nav span a").eq(0).addClass("spanActive");localStorage.navArr=JSON.stringify(navArr),localStorage.comidArr=JSON.stringify(comidArr)}}}});