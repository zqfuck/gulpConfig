"use strict";$(document).ready(function(){var c=localStorage.companyId?localStorage.companyId:getCompanyId("qy_companyid"),e=getQueryStringByName("columnid");$("#back").click(function(){window.history.back()}),$(".focusSkip").focus(function(){$(".searchMask").show(),$("#zq-search").focus(),$(".listL").empty(),$(".listHot").empty();var e="";function t(){$.ajax({url:URL+"/appapi/wx/search",type:"get",dataType:"json",cache:!1,data:{id:c,value:e,pagesize:10,page:1},error:function(e){console.log(e)},success:function(e){var t;0==e.state.rc&&($(".listL").empty(),t=e.result.items,$.each(t,function(e,t){var o={nameSearch:t.name,nameLink:"details.html?cid="+t.cid+"&qy_companyid="+c},n=$("#nameList").render(o);$(".listL").append(n)}))}})}$("#zq-search").val(""),stop(),$.ajax({url:URL+"/webapi/banner/get-data",type:"get",dataType:"json",cache:!1,data:{id:c,type:3},error:function(e){console.log(e)},success:function(e){var o;0==e.state&&(e=e.data,o="",$.each(e,function(e,t){o+='<li class="zq-searchL zq-click">'+t.title+"</li>"}),$(".listHot").append(o))}}),$(".listHot").on("click",".zq-click",function(){$(".listL").empty(),e=$(this).text(),t()}),$("#zq-search").keyup(function(){$(".listL").empty(),$(".listL").removeClass("hidden"),e=$.trim($("#zq-search").val()),t()})}),$(".btn-nav").click(function(){stop(),$(".topHot").empty(),$(".topTenMask").show(),$.ajax({url:URL+"/webapi/banner/get-data",type:"get",dataType:"json",cache:!1,data:{id:c,type:2},error:function(e){console.log(e)},success:function(e){console.log(e),0==e.state&&(e=e.data,$.each(e,function(e,t){var o={nameSearch:t.title,top:e+1,nameLink:"details.html?cid="+t.cid+"&qy_companyid="+c},n=$("#topList").render(o);$(".topHot").append(n),$(".topBj").eq(0).css({background:"#ee3e3e"}),$(".topBj").eq(1).css({background:"#ee993e"}),$(".topBj").eq(2).css({background:"#eedf3e"})}))}})}),$(".zq-cancel").click(function(){$(".searchMask").hide(),move()}),$(".topCancel").click(function(){$(".topTenMask").hide(),move()});new Vue({el:"#app",data:{message:[],page:1,timeLeft:null,pagesize:6,count:"",timeOutMessage:[],lock:!1},methods:{scrollBottom:function(){},toDetail:function(e){window.location.href="./details.html?cid="+e+"&qy_companyid="+c},liveType:function(e,t,o){var n=(new Date).getTime();return 3==e?"回放":1==e?o<n?"直播":1==t?"预约":"敬请期待":2==e?"点播":void 0},timeOut:function(){},leftTimea:function(e){var t=e,o=parseInt(t/1e3/60/60,10),n=parseInt(t/1e3/60%60,10),c=parseInt(t/1e3%60,10);return e=(o=this.checkTime(o))+":"+(n=this.checkTime(n))+":"+(c=this.checkTime(c))},checkTime:function(e){return e<10&&(e="0"+e),e},loadMore:function(){var e=Math.ceil(this.count/this.pagesize);this.page<=e&&this.list()},toBook:function(o){$(".bookBox").show(),$(".bookVideo").show(),$("#zq-btn").unbind(),getCode(),$("#zq-BookC").click(function(){$(".bookBox").hide(),$(".bookVideo").hide()}),$("#zq-btn").bind("click",function(){var e=$("#tel").val(),t=$("#bookCode").val();""!=e&&checkPhone(e)?""!=t?$.ajax({url:URL+"/appapi/wx/book",type:"get",dataType:"json",data:{id:o,phone:e,imgcode:t,timeflag:timeflag2},error:function(e){console.log(e)},success:function(e){return console.log(e),0==e.state.rc?($("#tel").val(""),$("#bookCode").val(""),showTip(e.state.msg),$(".bookBox").hide(),void $(".bookVideo").hide()):void showTip(e.state.msg)}}):showTip("请输入图片验证码"):showTip("请输入正确手机号码")})},getScrollTop:function(){var e=0;return document.documentElement&&document.documentElement.scrollTop?e=document.documentElement.scrollTop:document.body&&(e=document.body.scrollTop),e},getClientHeight:function(){return document.body.clientHeight&&document.documentElement.clientHeight?Math.min(document.body.clientHeight,document.documentElement.clientHeight):Math.max(document.body.clientHeight,document.documentElement.clientHeight)},list:function(){var o=this;$.ajax({url:URL+"/appapi/wx/channellist",type:"get",dataType:"json",cache:!1,data:{columnid:e,page:this.page,pagesize:this.pagesize},error:function(e){console.log(e)},success:function(e){if(o.page++,console.log(e),0==e.state.rc){o.count=e.result.totalcount;for(var t=0;t<e.result.items.length;t++)o.message.push(e.result.items[t]);console.log(o.message),o.message.forEach(function(e){var t=o.timeOutMessage.indexOf(e);e.count_num&&-1==t&&o.timeOutMessage.push(e)}),console.log(o.timeOutMessage),o.lock=!0}}})},liveTypeBg:function(e,t){return 1==t?"status beforeLive":2==e||3==e?"status backLive":"status nowLive"},getScrollHeight:function(){return Math.max(document.body.scrollHeight,document.documentElement.scrollHeight)},upCallback:function(){this.list()}},created:function(){var n=this;this.list(),setInterval(function(){n.timeOutMessage.forEach(function(e,t){var o;e.count_num-=1e3,e.count_num<=0?$(".apportTimeout").eq(t).css("display","none"):(o=n.leftTimea(e.count_num),$(".timeFont").eq(t).html(o))})},1e3)},mounted:function(){var e=this;window.onscroll=function(){e.getScrollTop()+e.getClientHeight()>=e.getScrollHeight()-60&&e.lock&&(e.loadMore(),e.lock=!1)}}})});